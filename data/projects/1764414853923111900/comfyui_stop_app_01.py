"""
=============================================================================
ComfyUI é‡å¯æœåŠ¡
=============================================================================
åœæ­¢ ComfyUI ä¸»æœåŠ¡ï¼Œä¸‹æ¬¡è®¿é—® URL æ—¶ä¼šè‡ªåŠ¨é‡å¯å¹¶åŠ è½½æ–°èŠ‚ç‚¹

ä½¿ç”¨æ–¹æ³•:
    modal run <è„šæœ¬å>.py

æ³¨æ„:
    - æ·»åŠ èŠ‚ç‚¹åè¿è¡Œæ­¤è„šæœ¬
    - æœåŠ¡åœæ­¢åè®¿é—® URL ä¼šè‡ªåŠ¨é‡å¯
    - é‡å¯æ—¶ä¼šè‡ªåŠ¨é“¾æ¥ Volume ä¸­çš„èŠ‚ç‚¹å¹¶å®‰è£…ä¾èµ–
=============================================================================
"""
import modal
import subprocess

# é…ç½®å‚æ•°
APP_NAME = "z-image-turbo"

app = modal.App("comfyui-restart-helper")


@app.local_entrypoint()
def main():
    """åœæ­¢ ComfyUI ä¸»æœåŠ¡"""
    print(f"\n{'='*60}")
    print(f"ğŸ”„ é‡å¯ ComfyUI æœåŠ¡")
    print(f"{'='*60}")
    print(f"åº”ç”¨åç§°: {APP_NAME}")
    print(f"{'='*60}\n")
    
    print("â¹ï¸ æ­£åœ¨åœæ­¢æœåŠ¡...")
    result = subprocess.run(
        ["modal", "app", "stop", APP_NAME],
        capture_output=True,
        text=True
    )
    
    if result.returncode == 0:
        print("âœ… æœåŠ¡å·²åœæ­¢")
        print("\nğŸ“Œ åç»­æ­¥éª¤:")
        print("   1. è®¿é—® ComfyUI URLï¼ŒæœåŠ¡ä¼šè‡ªåŠ¨é‡å¯")
        print("   2. é‡å¯æ—¶ä¼šè‡ªåŠ¨åŠ è½½ Volume ä¸­çš„æ–°èŠ‚ç‚¹")
        print("   3. èŠ‚ç‚¹ä¾èµ–ä¼šè‡ªåŠ¨å®‰è£…")
    else:
        print(f"âš ï¸ åœæ­¢æœåŠ¡æ—¶å‡ºç°é—®é¢˜: {result.stderr}")
    
    print(f"\n{'='*60}")
