# 脚本编辑器使用指南

## 快速开始

### 创建新脚本
1. 进入项目详情页
2. 点击左侧"新建脚本"按钮
3. 填写脚本信息
4. 点击"创建脚本" - 自动跳转到编辑器

### 编辑脚本
1. 在项目详情页选择脚本
2. 点击"查询详情" - 跳转到编辑器

## 编辑器布局

```
┌─────────────────────────────────────────────────────────┐
│  ← 返回  | 脚本编辑器 | [格式化] [打开IDE] [AI分析] [保存] │
├──────────┬──────────────────────────────────────────────┤
│          │  基本信息                                      │
│  代码    │  - 脚本名称                                    │
│  片段    │  - 文件路径                                    │
│  库      │  - 脚本描述                                    │
│          │                                                │
│  🔧 Modal│  Python 代码                                  │
│  📦 模型  │  ┌──────────────────────────────────────┐   │
│  ⚙️  环境  │  │  import modal                         │   │
│  🚀 服务  │  │  app = modal.App(name="my-app")      │   │
│  ⚡ 高级  │  │  # 光标在这里                          │   │
│          │  │                                        │   │
│  [搜索]  │  └──────────────────────────────────────┘   │
│          │                                                │
└──────────┴──────────────────────────────────────────────┘
```

## 代码片段分类

### 🔧 Modal 基础
- 基础应用模板
- 镜像配置（Debian、Conda）
- Volume 管理
- Secret 使用
- **定时任务**（Cron、Period）⭐
- GPU 配置

### 📦 模型下载
- **HuggingFace 下载**
- Civitai 下载
- URL 下载（带进度条）
- 批量下载

### ⚙️ 环境配置
- pip 依赖安装
- apt 系统包
- 环境变量
- 自定义命令

### 🚀 服务部署
- **FastAPI 服务**
- Gradio WebUI
- ComfyUI 部署
- Webhook 端点

### ⚡ 高级功能
- 类方法部署
- 并行执行
- 重试策略
- 共享数据

## 使用技巧

### 1. 快速搜索
在搜索框输入关键词：
- `schedule` - 查找定时任务
- `huggingface` - 查找模型下载
- `fastapi` - 查找 Web 服务
- `gpu` - 查找 GPU 配置

### 2. 智能插入
1. 将光标放在需要插入代码的位置
2. 点击代码片段右侧的复制图标
3. 代码自动插入，并保持正确缩进

### 3. 组合使用
例如创建一个定时模型下载任务：

1. 插入"基础应用模板"
2. 插入"Volume 创建"
3. 插入"HuggingFace 下载"
4. 插入"定时任务 (Cron)"
5. 修改参数完成

### 4. 快捷操作
- **格式化**: 一键美化 Python 代码
- **AI 分析**: 检查代码质量和潜在问题
- **打开 IDE**: 在 VS Code/PyCharm 中编辑
- **折叠侧边栏**: 需要更多编辑空间时

## 常见场景示例

### 场景 1: 每日下载 HuggingFace 模型
1. 搜索 "schedule"，插入"定时任务 (Cron)"
2. 搜索 "huggingface"，插入"HuggingFace 模型下载"
3. 搜索 "volume"，插入"挂载 Volume"
4. 修改 cron 表达式和模型名称

### 场景 2: 部署 ComfyUI 服务
1. 插入"ComfyUI 部署"
2. 插入"GPU 配置"
3. 插入"Volume 挂载"
4. 调整配置参数

### 场景 3: FastAPI + AI 模型服务
1. 插入"FastAPI Web 服务"
2. 插入"类方法部署"
3. 插入"GPU 配置"
4. 编写推理逻辑

## 注意事项

1. **保存前格式化**: 建议保存前点击"格式化"按钮
2. **缩进一致性**: 代码片段会自动适应当前缩进
3. **路径编码**: 脚本路径自动编码，支持中文和特殊字符
4. **AI 配置**: 使用 AI 分析前需在"AI 配置"页面设置

## 键盘快捷键（规划中）

- `Ctrl + S`: 保存
- `Ctrl + F`: 格式化
- `Ctrl + /`: 搜索片段
- `Ctrl + B`: 折叠侧边栏

## 问题排查

### 无法保存
- 检查文件权限
- 确认项目路径存在

### 代码片段不显示
- 刷新页面
- 检查搜索条件

### 缩进错误
- 使用"格式化"按钮修正
- 检查是否混用了 Tab 和空格

## 更新日志

### v1.0.0 (当前版本)
- ✅ 独立编辑器页面
- ✅ 50+ 代码片段
- ✅ 智能插入和自动缩进
- ✅ 搜索和分类管理
- ✅ AI 分析和格式化
- ✅ IDE 集成

### 计划中
- [ ] Monaco Editor 集成
- [ ] 自定义代码片段
- [ ] 键盘快捷键
- [ ] 代码补全
- [ ] 多标签页编辑

